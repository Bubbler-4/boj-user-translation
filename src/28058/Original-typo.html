<section id="title">Tsunami</section>
<section id="description">
				<div class="headline">
				<h2>문제</h2>
				</div>
				<div id="problem_description" class="problem-text">
				<p>Due to global warming and environmental crisis, we now need to make plans to survive for possible natural disasters. This time, we will make manuals for tsunamis.</p>



<p>The ocean line can be represented as a line parallel to the x-axis, $y=k$. Normally $k$ would be $0$, but when a tsunami occurs it will become a positive real number.</p>



<p>In our city, there will be $N$ evacuation spots represented as points $(p_i, q_i)$. At these spots, we will gather and move simultaneously. Also $r_i$ is given for each spot, which denotes the time (in minutes) for you to go to that particular spot.</p>



<p>There will be obstacles to evacuation. For simplicity, we assume obstacles are straight-lined and parallel to the x-axis.</p>



<p>A total of $M$ obstacles are given as $(s_i, e_i, y_i, t_i)$, which are line segments connecting $(s_i, y_i)$ and $(e_i, y_i)$ that takes $t_i$ minutes to cross. Note that it also takes $t_i$ minutes crossing the obstacle even at the endpoints. No obstacles and evacuation spots coincide.</p>



<p>However obstacles themselves may overlap. In that case, the time crossing the overlapped obstacle is the sum of the overlapping $t_i$s. For example, if there are 2 obstacles $(1, 4, 2, 5)$ and $(3, 5, 2, 7)$, it will take $5$ minutes to cross at $x=1$, $5+7=12$ minutes to cross at $x=3$, $7$ minutes to cross at $x=5$.</p>



<p>We will only move upwards(i.e. +y direction) until we reach $y=Y$, which is the safe zone. While moving upwards, we can move our x-coordinates too. It takes $c_i$ minutes per coordinate to move along the x-axis when our current y-coordinate is between $i$ and $i+1$. For example when $c_3=5$ and we move our x-coordininate from $10$ to $6$ at $y=3.5$, it will take $5\times |10-6|=20$ minutes.</p>



<p>We can only move to integer x-coordinates, and also can safely assume that we don&#39;t change x-coordinates at integer y-coordinates. Keep in mind that this is the only constraint. We can move to either $x=-100$ or $x=10^{100}$, if you want.</p>



<p>Also note that $c_1, ..., c_{Y-1}$ is a nondecreasing sequence, since the number of people as $y$ increases will also increase, and therefore it will get harder to move between them.</p>



<p>The evacuation manual is as follows:</p>



<ul>

	<li>1. We move to an appropriate evacuation spot.</li>

	<li>2. Starting from the spot, we move to $y=Y$ under the given constraints.</li>

</ul>



<p>We do not consider time moving simply upwards as it is nearly constant regardless of our starting evacuation spots. We only consider time moving to an evacuation spot, moving horizontally, and crossing obstacles.</p>



<p>Let&#39;s calculate the minimum possible time in minutes to evacuate to $(1, Y)$, $(2, Y)$, ..., $(X, Y)$ respectively.</p>


				</div>
				</section>
<section id="input">
					<div class="headline">
					<h2>입력</h2>
					</div>
					<div id="problem_input" class="problem-text">
					<p>The first line contains two space-separated integers $X$ and $Y$.</p>



<p>The second line contains two space-separated integers $N$ and $M$.</p>



<p>Each of the following $N$ lines contain three space-separated integers $p_i$, $q_i$, $r_i$ which denotes the $i$th evacuation spot.</p>



<p>Each of the following $M$ lines contain four space-separated integers $s_i$, $e_i$, $y_i$, $t_i$ which denotes the $i$th obstacle.</p>



<p>The last line contains $Y-1$ space-sperated integers $c_1$, $c_2$, ..., $c_{Y-1}$. $c_i$ denotes the speed of changing the x-coordinate when your y-coordinate is between $[i, i+1]$.</p>


					</div>
					</section>
<section id="output">
					<div class="headline">
					<h2>출력</h2>
					</div>
					<div id="problem_output" class="problem-text">
					<p>Print $X$ lines. In the $i$th line, print a single integer denoting the minimum time (in minutes) to reach point $(i, Y)$.</p>


					</div>
					</section>
<section id="limit">
			<div class="headline">
			<h2>제한</h2>
			</div>
			<div id="problem_limit" class="problem-text">
			<ul>

	<li>$3\leq X, Y\leq 2\times 10^5$</li>

	<li>$1\leq N\leq 2\times 10^5$</li>

	<li>$0\leq M\leq 2\times 10^5$</li>

	<li>$1\leq p_i\leq X$, $1\leq q_i&lt;Y$, $0\leq r_i\leq 10^{15}$</li>

	<li>$1\leq s_i\leq e_i\leq X$, $2\leq y_i&lt;Y$, $0\leq t_i\leq 10^9$</li>

	<li>$0\leq c_1\leq c_2\leq ...\leq c_{Y-1}\leq 10^6$</li>

</ul>

			</div>
			</section>
<section id="subtask"><div class="headline"><h2>서브태스크</h2></div><div id="problem_subtask" class="problem-text"><div class="table-responsive"><table class="table table-bordered td-middle subtask-table" style="width: 100%;"><thead><th style="width: 5%;">번호</th><th style="width: 5%;">배점</th><th style="width: 90%;">제한</th></thead><tbody><tr data-subtask-id="1"><td>1</td><td>11</td><td class="subtask-body"><p>$X&le;2000$</p>



<p>$Y&le;2000$</p>

</td></tr><tr data-subtask-id="2"><td>2</td><td>7</td><td class="subtask-body"><p>$X&le;400$</p>



<p>$N&le;50000$</p>



<p>$M&le;400$</p>

</td></tr><tr data-subtask-id="3"><td>3</td><td>10</td><td class="subtask-body"><p>$X&le;400$</p>



<p>$N&le;50000$</p>



<p>$M&le;50000$</p>

</td></tr><tr data-subtask-id="4"><td>4</td><td>23</td><td class="subtask-body"><p>$M=0$</p>

</td></tr><tr data-subtask-id="5"><td>5</td><td>25</td><td class="subtask-body"><p>$c_1 = c_2 = ...= c_{Y-1}$</p>

</td></tr><tr data-subtask-id="6"><td>6</td><td>24</td><td class="subtask-body"><p>This subtask has no additional constraints.</p>
<!-- https://www.acmicpc.net/board/view/122463 -->

</td></tr></tbody></table></div></div></section>
