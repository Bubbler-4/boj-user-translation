<section id="title">합병</section>
<section id="description">
  <div class="headline">
    <h2>문제</h2>
  </div>
  <div id="problem_description" class="problem-text">
    <p>
      JOI합중국에는 $N$개의 도시가 있어서, 1번부터 $N$번까지의 번호가 붙어 있다.
      또한, JOI합중국에는 $N-1$개의 국도가 있다. $i$번째($1 \le i \le N-1$)
      국도는 $A_i$번 도시와 $B_i$번 도시를 양방향으로 잇는다. 어떤 두 도시에
      대해서도, 국도 몇 개를 이용하면 서로 오가는 것이 가능하다.
    </p>

    <p>
      현재, JOI합중국은 1번부터 $K$번까지의 번호가 붙어있는 $K$개의 주로 나뉘어
      있다. $j$번 ($1 \le j \le N$)도시는 $S_j$번 주에 속한다. 모든 주에는
      적어도 하나의 도시가 속해 있다.
    </p>

    <p>
      JOI합중국의 대통령인 $K$ 이사장은, 이 나라가 분열하지 않을까 걱정이
      되었다. 다음 조건을 모두 만족하도록 모든 도시를 2개의 그룹 $X$, $Y$로
      나누는 것이 가능할 때, JOI합중국은 <strong>분열가능</strong>한 상태라고
      말한다.
    </p>

    <ul>
      <li>모든 도시는 그룹 $X$혹은 그룹 $Y$에 속한다.</li>
      <li>그룹 $X$에는 적어도 하나의 도시가 속해 있다.</li>
      <li>그룹 $Y$에는 적어도 하나의 도시가 속해 있다.</li>
      <li>
        모든 주에 대해서, 그 주에 있는 모든 도시는 모두 같은 그룹에 속해 있다.
      </li>
      <li>
        그룹 $X$에 속한 어떤 두 도시에 대해서도, 그룹 $X$에 속한 도시만을
        경유해서 서로 오가는 것이 가능하다.
      </li>
      <li>
        그룹 $Y$에 속한 어떤 두 도시에 대해서도, 그룹 $Y$에 속한 도시만을
        경유해서 서로 오가는 것이 가능하다.
      </li>
    </ul>

    <p>
      $K$ 이사장은, JOI합중국이 분열가능하지 않은 상태를 만들기 위해, 주를
      합병하려고 한다. 한 번의 합병은 두 개의 주를 골라서 합치는 것을 말한다.
      새로운 주는, 기존의 두 주에 속해 있던 도시들이 속해 있다. $K$ 이사장은
      주를 최소한의 횟수만큼 합병하여 JOI합중국을 분열가능하지 않은 상태로
      만들고 싶어 한다.
    </p>

    <p>
      도시와 국도의 위치, 현재 어떤 도시가 어떤 주에 속해있는지 주어졌을 때, JOI
      합중국이 분열가능하지 않은 상태로 만들기 위한 합병의 최소 횟수를 구하는
      프로그램을 작성하여라.
    </p>
  </div>
</section>
<section id="input">
  <div class="headline">
    <h2>입력</h2>
  </div>
  <div id="problem_input" class="problem-text">
    <p>표준 입력에서 다음과 같은 형식으로 주어진다. 모든 값은 정수이다.</p>

    <p>$N$ $K$</p>

    <p>$A_1$ $B_1$</p>

    <p>$\vdots$</p>

    <p>$A_{N-1}$ $B_{N-1}$</p>

    <p>$S_1$</p>

    <p>$\vdots$</p>

    <p>$S_N$</p>
  </div>
</section>
<section id="output">
  <div class="headline">
    <h2>출력</h2>
  </div>
  <div id="problem_output" class="problem-text">
    <p>
      JOI합중국을 분열가능하지 않은 상태로 만들기 위한 합병의 최소 횟수를 표준
      출력의 첫째 줄에 출력하여라.
    </p>
  </div>
</section>
<section id="limit">
  <div class="headline">
    <h2>제한</h2>
  </div>
  <div id="problem_limit" class="problem-text">
    <ul>
      <li>$1 \le N \le 500\ 000$.</li>
      <li>$1 \le K \le N$.</li>
      <li>$1 \le A_i \le N$ ($1 \le i \le N-1$).</li>
      <li>$1 \le B_i \le N$ ($1 \le i \le N-1$).</li>
      <li>
        어떤 두 도시에 대해서도, 국도 몇 개를 이용하면 서로 오가는 것이
        가능하다.
      </li>
      <li>$1 \le S_j \le K$ ($1 \le j \le N$)</li>
      <li>
        모든 $k$ ($1 \le k \le K$)에 대해, $S_j = k$를 만족하는 $j$ ($1 \le j
        \le N$)가 존재한다.
      </li>
    </ul>
  </div>
</section>
<section id="subtask">
  <div class="headline"><h2>서브태스크</h2></div>
  <div id="problem_subtask" class="problem-text">
    <div class="table-responsive">
      <table
        class="table table-bordered td-middle subtask-table"
        style="width: 100%"
      >
        <thead>
          <th style="width: 5%">번호</th>
          <th style="width: 5%">배점</th>
          <th style="width: 90%">제한</th>
        </thead>
        <tbody>
          <tr data-subtask-id="1">
            <td>1</td>
            <td>10</td>
            <td class="subtask-body"><p>N &le; 100, K &le; 7.</p></td>
          </tr>
          <tr data-subtask-id="2">
            <td>2</td>
            <td>24</td>
            <td class="subtask-body"><p>N &le; 3 000.</p></td>
          </tr>
          <tr data-subtask-id="3">
            <td>3</td>
            <td>14</td>
            <td class="subtask-body"><p>N &le; 100 000, K &le; 50.</p></td>
          </tr>
          <tr data-subtask-id="4">
            <td>4</td>
            <td>22</td>
            <td class="subtask-body">
              <p>
                N &le; 100 000. 처음 상태에서 최대 100개의 국도만을 이용해 같은
                주에 속한 두 도시를 오가는 것이 가능하다.
              </p>
            </td>
          </tr>
          <tr data-subtask-id="5">
            <td>5</td>
            <td>30</td>
            <td class="subtask-body"><p>추가 제약 조건 없음</p></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>
<section id="sample_explain_1">
  <div id="problem_sample_explain_1" class="problem-text">
    <p>
      이 예제에서는, 처음의 상태는 분열가능하다. 예를 들면, 1번, 2번, 3번, 4번
      도시를 그룹 $X$라 하고, 5번 도시를 그룹 $Y$라고 하면 된다.
    </p>

    <p>
      3번 주와 4번 주를 합병할 경우 분열가능하지 않은 상태가 된다. 그러므로 답은
      1이다.
    </p>
  </div>
</section>
<section id="sample_explain_2">
  <div id="problem_sample_explain_2" class="problem-text">
    <p>이 예제에서는, 처음의 상태는 분열가능하지 않다. 그러므로 답은 0이다.</p>
  </div>
</section>
